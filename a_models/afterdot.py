# Import
import mysql.connector  
import time
  
def afterdot(table, space):  
    # ----------------------------------------------------------   
    space += "__"
    # ---------------------------------------------------------- 
    print(space + "afterdot()", flush=True)
    # ----------------------------------------------------------  
    host="localhost"
    user="root" 
    database="pr_laravel_8_vacancyonbert_2023_05"
    mydb = mysql.connector.connect(host=host,user=user,password="",database=database) 
    # ----------------------------------------------------------   
    query = "Select " 
    query += " id "   
    query += " , name "       
    query += " from datasets "      
    query += " where name LIKE '.' "    
    query += " and id > 8792673 "   
    query += " order by id asc "       
    # query += " limit 10 "     
    # ----------------------------------------------------------   
    space += "__"
    # ----------------------------------------------------------   
    # print(space + query)
    # ----------------------------------------------------------   
    mycursor = mydb.cursor()
    mycursor.execute(query)
    result =  mycursor.fetchall()
    # ----------------------------------------------------------   
    space += "__"
    # ---------------------------------------------------------- 
    total_rows = len(result)
    print(space + "Total Row(s) : " + str(total_rows), flush=True) 
    # ----------------------------------------------------------  
    mycursor.close()
    mydb.close()
    # ---------------------------------------------------------- 
    counter = 0 
    # ----------------------------------------------------------
    for x in result:     
        # ------------------------------------------------------
        time.sleep(0.05)
        # ------------------------------------------------------
        counter         += 1  
        # ------------------------------------------------------
        idx         = x[0]   
        nama        = str(x[1].strip())      
        # ------------------------------------------------------   
        word = space + "__[" + str(counter) + "/" +str(total_rows) + "] "
        word += " #" + str(idx)  
        word += " __ " + nama          
        # print(word, flush=True)    
        # ------------------------------------------------------ 
        checkdot(table, idx, space) 
        # ------------------------------------------------------   
        word = ""
        # print(word, flush=True)    
        # ------------------------------------------------------   
    # ----------------------------------------------------------
    # ----------------------------------------------------------
    # ----------------------------------------------------------
 
def checkdot(table, idxX, space):  
    # ----------------------------------------------------------   
    space += "__"
    # ---------------------------------------------------------- 
    # print(space + "checkdot()", flush=True)
    # ----------------------------------------------------------  
    host="localhost"
    user="root" 
    database="pr_laravel_8_vacancyonbert_2023_05"
    mydb = mysql.connector.connect(host=host,user=user,password="",database=database) 
    # ----------------------------------------------------------   
    query = "Select " 
    query += " id "   
    query += " , name "       
    query += " from datasets "      
    query += " where id > " + str(idxX)     
    query += " order by id asc "      
    query += " limit 1 "      
    # ----------------------------------------------------------   
    space += "__"
    # ----------------------------------------------------------   
    # print(space + query)
    # ----------------------------------------------------------   
    mycursor = mydb.cursor()
    mycursor.execute(query)
    result =  mycursor.fetchall()
    # ----------------------------------------------------------   
    space += "__"
    # ---------------------------------------------------------- 
    total_rows = len(result)
    # print(space + "Total Row(s) : " + str(total_rows), flush=True) 
    # ----------------------------------------------------------  
    mycursor.close()
    mydb.close()
    # ---------------------------------------------------------- 
    counter = 0 
    # ----------------------------------------------------------
    for x in result:     
        # ------------------------------------------------------
        time.sleep(0.05)
        # ------------------------------------------------------
        counter         += 1  
        # ------------------------------------------------------
        idx         = x[0]   
        nama        = str(x[1].strip())      
        # ------------------------------------------------------   
        word = space + "__[" + str(counter) + "/" +str(total_rows) + "] "
        word += " #" + str(idx)  
        word += " __ " + nama          
        # print(word, flush=True)    
        # ------------------------------------------------------ 
        if(nama == '.'):       
            # -------------------------------------------------- 
            # updated_afterdot(idx, 1, space)
            aa = ""
            # -------------------------------------------------- 
        else:       
            # -------------------------------------------------- 
            updated_afterdot(idx, 2, space)
            # -------------------------------------------------- 
        # ------------------------------------------------------    
    # ----------------------------------------------------------
    # ----------------------------------------------------------
    # ----------------------------------------------------------

    
def updated_afterdot(idx, value, space):  
    # ----------------------------------------------------------   
    space += "__"
    # ----------------------------------------------------------  
    # print(space + "updated_afterdot()", flush=True)
    # ----------------------------------------------------------  
    host="localhost"
    user="root" 
    database="pr_laravel_8_vacancyonbert_2023_05"
    mydb = mysql.connector.connect(host=host,user=user,password="",database=database) 
    # ----------------------------------------------------------  
    query_commit = "UPDATE `datasets` SET "
    # ----------------------------------------------------------   
    query_commit += " `after_dot` = '" + str(value) + "' "      
    # ----------------------------------------------------------   
    query_commit += " WHERE id = '" + str(idx) + "' "  
    # ----------------------------------------------------------   
    space += "__"
    # ----------------------------------------------------------  
    # print(space + query_commit, flush=True)
    # ----------------------------------------------------------  
    mycursor = mydb.cursor()
    mycursor.execute(query_commit)
    mydb.commit()     
    # ----------------------------------------------------------  
    mycursor.close()
    mydb.close()
    # ----------------------------------------------------------  
    # ----------------------------------------------------------  
    # ----------------------------------------------------------